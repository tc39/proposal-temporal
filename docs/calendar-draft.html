<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Temporal documentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/light.min.css">
    <script type="application/javascript" src="./playground.js"></script>
    <link rel="stylesheet" type="text/css" href="./prism.css">
    <script>
      Temporal = { ...temporal.Temporal };
      Object.assign(Intl, temporal.Intl);

      // Customize output of Temporal objects for Chrome DevTools
      if (!window.devtoolsFormatters)
        window.devtoolsFormatters = [];
      window.devtoolsFormatters.push({
        header(x) {
          for (const type of [
            Temporal.Instant,
            Temporal.PlainDate,
            Temporal.PlainDateTime,
            Temporal.Duration,
            Temporal.PlainMonthDay,
            Temporal.PlainTime,
            Temporal.PlainYearMonth
          ]) {
            if (x instanceof type) return ['span', {}, `${x[Symbol.toStringTag]} <${x}>`];
          }
          return null;
        },
        hasBody(x) {
          return x instanceof Temporal.Duration;
        },
        body(x) {
          const out = ['ol', { style: 'list-style-type: none;' }];
          for (const prop of [
            'years',
            'months',
            'weeks',
            'days',
            'hours',
            'minutes',
            'seconds',
            'milliseconds',
            'microseconds',
            'nanoseconds'
          ]) {
            if (x[prop] !== 0) out.push([
              'li',
              {},
              ['span', { style: 'color: purple;' }, prop],
              `: `,
              ['span', { style: 'color: blue;' }, x[prop]]
            ]);
          }
          return out;
        }
      });
    </script>
    <style>
      /* https://github.com/kognise/water.css/blob/master/src/variables-light.css */
      :root {
        --background: #efefef;
        --text-muted: #999999;
        --text-bright: #000000;
        --text-width: 900px;
        --variable: #39a33c;
      }
      body {
        font-size: 18px;
        max-width: var(--text-width);
        padding-top: 40px;  /* extra padding for banner */
        line-height: 1.5;
      }
      pre { border-left: 4px solid var(--variable); }
      code {
        padding: 1px 5px 2px 5px;
        line-height: 1.1;
        display: inline-block;
      }
      a code { color: inherit; }
      a code:hover { text-decoration: underline; }
      pre code { line-height: 1.4; }
      pre code[class*="language-"] { font-size: 0.85em; }
      pre[class*="language-"] { padding: 0.5em; }
      h1 { margin-top: 13px; }
      h2 { border-bottom: 2px solid var(--text-muted); margin-top: 2em; }
      h3 {
        border-bottom: 1px solid var(--text-muted);
        color: var(--text-muted);
        font-weight: normal;
      }
      h3 em { font-weight: bold; }
      h3 strong { color: var(--text-bright); }
      :not(h2) + h3 { margin-top: 2em; }
      footer {
        border-top: 1px solid var(--background);
        color: var(--text-muted);
        font-size: 0.8em;
        margin-top: 2em;
        padding-top: 10px;
      }
      .heading-link {
        left: calc((100vw - var(--text-width)) / 2 - 1.5em);
        opacity: 0;
        position: absolute;
        transition: opacity 150ms;
      }
      .heading-link:hover { text-decoration: none; }
      .heading-link::before { content: 'Â¶'; }
      h2:hover .heading-link, h3:hover .heading-link, h4:hover .heading-link, h5:hover .heading-link { opacity: 0.75; }
      .banner {
        background-color: #ffcc7a;
        background-size: 20px 20px;
        box-shadow: 0 5px 0 rgba(0, 0, 0, .1);
        left: 0;
        padding: 0.4em 0;
        position: absolute;
        text-align: center;
        top: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="banner">
      Please visit Temporal documentation on <strong>
        <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Temporal">MDN,</a>
      </strong> the main API reference going forward.
      Or see our <strong><a href="cookbook.html">cookbook</a></strong>.
    </div>
<h1 id="draft-design-of-temporal-calendar-api"><a class="heading-link" href="#draft-design-of-temporal-calendar-api"></a>Draft Design of Temporal Calendar API</h3><p>This doc describes a design for first-class support for non-Gregorian <a href="https://en.wikipedia.org/wiki/Calendar">calendars</a> in Temporal. Although most of this document is based on Temporal.PlainDate, most of this applies to Temporal.PlainDateTime, Temporal.PlainYearMonth, Temporal.PlainMonthDay, and Temporal.PlainTime as well.</p>
<p>The approach described in this document was largely adopted, but most of
this document&#39;s information is nonetheless obsolete, due to removing the
Temporal.Calendar interface.</p>
<h2 id="data-model"><a class="heading-link" href="#data-model"></a>Data Model</h3><h3 id="temporalplaindate-internal-slots"><a class="heading-link" href="#temporalplaindate-internal-slots"></a>Temporal.PlainDate internal slots</h3><p>Main issue: <a href="https://github.com/tc39/proposal-temporal/issues/290">https://github.com/tc39/proposal-temporal/issues/290</a></p>
<p>Temporal.PlainDate currently has three internal slots: year, month, and day. (An &quot;internal slot&quot; refers to actual data, as opposed to &quot;properties&quot;, which could be computed.) In this proposal, those slots are renamed to <code>[[ISOYear]]</code>, <code>[[ISOMonth]]</code>, and <code>[[ISODay]]</code>, and an additional <code>[[Calendar]]</code> slot is added. The calendar slot contains an object implementing the Temporal.Calendar interface, described below.</p>
<p>No matter which calendar system is being represented, the <em>data model</em> in Temporal.PlainDate remains indexed in the ISO calendar. So, for instance, if you wanted to represent the Hebrew date 5 Nisan 5780, the data model would be 2020-03-30, and the calendar would be responsible for mapping that into the corresponding Hebrew fields, as described further down in this document.</p>
<p>This data model makes the simple assumption that the concept of a &quot;day&quot; is a solar day (main issues: <a href="https://github.com/tc39/proposal-temporal/issues/390">#390</a>, <a href="https://github.com/tc39/proposal-temporal/issues/389">#389</a>). Most or all modern-use calendars, even those with lunar month cycles, use a solar day, which is based on the time it takes for the Earth to complete one rotation relative to the Sun.</p>
<p>The acclaimed researchers Edward M. Reingold and Nachum Dershowitz discuss this subject in <a href="https://www.cambridge.org/fr/academic/subjects/computer-science/computing-general-interest/calendrical-calculations-ultimate-edition-4th-edition"><em>Calendrical Calculations</em></a>:</p>
<blockquote>
<p>The sun moves from east to west, and night follows day with predictable regularity. This apparent motion of the sun as viewed by an earthbound observer provided the earliest time-keeping standard for humankind. The day is, accordingly, the basic unit of time underlying all calendars, but various calendars use different conventions to structure days into larger units: weeks, months, years, and cycles of years.</p>
</blockquote>
<p>Some historical calendars, such as the Hawaiian Moon Calendar, define a day as the time it takes for the Earth to complete one rotation relative to the moon (instead of the Sun), which is slightly shorter on average. For calendars that use a lunar day, a Temporal.PlainDateTime can be used instead of Temporal.PlainDate when the distinction is important.</p>
<p>At this time, Temporal does not support subdividing a solar day into anything other than hours, minutes, and seconds.
However, we have taken a future-proof approach so that if a use case presents itself, we can add <code>timePlus()</code>, <code>timeMinus()</code>, and <code>timeDifference()</code> methods to Temporal.Calendar.</p>
<h3 id="temporalplaindatetime-and-temporalplaintime-internal-slots"><a class="heading-link" href="#temporalplaindatetime-and-temporalplaintime-internal-slots"></a>Temporal.PlainDateTime and Temporal.PlainTime internal slots</h3><p>As with Temporal.PlainDate, all of these types will gain a <code>[[Calendar]]</code> slot, and year, month, and day will be renamed <code>[[ISOYear]]</code>, <code>[[ISOMonth]]</code>, and <code>[[ISODay]]</code>.</p>
<h3 id="temporalplainyearmonth-and-temporalplainmonthday-internal-slots"><a class="heading-link" href="#temporalplainyearmonth-and-temporalplainmonthday-internal-slots"></a>Temporal.PlainYearMonth and Temporal.PlainMonthDay internal slots</h3><p>Main issue: <a href="https://github.com/tc39/proposal-temporal/issues/391">https://github.com/tc39/proposal-temporal/issues/391</a></p>
<p>For reasons explained above, using the ISO calendar as the internal data model has many advantages. However, there are several challenges for these two &quot;incomplete&quot; types: lunar months don&#39;t line up with solar months, and not every lunar month occurs in every solar year. After discussing several data model alternatives, we reached the conclusion that the simplest data model for Temporal.PlainYearMonth and Temporal.PlainMonthDay is to make it share the same data model as Temporal.PlainDate, with the same slots.</p>
<p>For calendars that use ISO-style months, such as Gregorian, Solar Buddhist, and Japanese, &quot;ISODay&quot; and &quot;ISOYear&quot; can be ignored for YearMonth and MonthDay respectively. However, for lunar and lunisolar calendars, such as Hebrew, Saudi Arabian Islamic, and Chinese, these fields allow those calendars to disambiguate which YearMonth and MonthDay are being represented.</p>
<h2 id="temporalcalendar-interface"><a class="heading-link" href="#temporalcalendar-interface"></a>Temporal.Calendar interface</h3><p>Main issue: <a href="https://github.com/tc39/proposal-temporal/issues/289">https://github.com/tc39/proposal-temporal/issues/289</a></p>
<p>The new Temporal.Calendar interface is a mechanism to allow arbitrary calendar systems to be implemented on top of Temporal. <strong><em>Most users will not encounter the Temporal.Calendar interface directly</em></strong>, unless they are building or using a non-built-in calendar system.</p>
<p>All built-in calendars will be instances of Temporal.Calendar (main issue: <a href="https://github.com/tc39/proposal-temporal/issues/300">#300</a>), and Temporal.Calendar can be subclassed. However, an object need not be a subclass of Temporal.Calendar to conform to the interface, which are the string methods listed below.</p>
<p>We had also considered using symbols, but settled on strings after discussion with the plenary (main issue: <a href="https://github.com/tc39/proposal-temporal/issues/310">#310</a>).</p>
<p>If a custom calendar needs to cache per-object information about the localized year, month, and day of a Temporal object, it can use a WeakMap for this purpose, with the Temporal object as the key into the WeakMap.</p>
<h3 id="methods-on-the-temporalcalendar-interface"><a class="heading-link" href="#methods-on-the-temporalcalendar-interface"></a>Methods on the Temporal.Calendar interface</h3><p>All of the following methods return new Temporal objects.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">class</span> <span class="token class-name">Temporal<span class="token punctuation">.</span>Calendar</span> <span class="token punctuation">{</span>
    <span class="token comment">/** Constructs a Temporal.PlainDate from a free-form option bag */</span>
    <span class="token function">dateFromFields</span><span class="token punctuation">(</span>
        <span class="token literal-property property">fields</span><span class="token operator">:</span> object<span class="token punctuation">,</span>
        <span class="token function-variable function">constructor</span><span class="token operator">:</span> <span class="token keyword">function</span>
    <span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">;</span>

    <span class="token comment">/** Constructs a Temporal.PlainYearMonth from a free-form option bag */</span>
    <span class="token function">yearMonthFromFields</span><span class="token punctuation">(</span>
        <span class="token literal-property property">fields</span><span class="token operator">:</span> object<span class="token punctuation">,</span>
        <span class="token function-variable function">constructor</span><span class="token operator">:</span> <span class="token keyword">function</span>
    <span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainYearMonth<span class="token punctuation">;</span>

    <span class="token comment">/** Constructs a Temporal.PlainMonthDay from a free-form option bag */</span>
    <span class="token function">monthDayFromFields</span><span class="token punctuation">(</span>
        <span class="token literal-property property">fields</span><span class="token operator">:</span> object<span class="token punctuation">,</span>
        <span class="token function-variable function">constructor</span><span class="token operator">:</span> <span class="token keyword">function</span>
    <span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainMonthDay<span class="token punctuation">;</span>

    <span class="token comment">/** A string identifier for this calendar */</span>
    <span class="token literal-property property">id</span> <span class="token operator">:</span> string<span class="token punctuation">;</span>

    <span class="token function">fields</span><span class="token punctuation">(</span>
        <span class="token literal-property property">fields</span><span class="token operator">:</span> array<span class="token operator">&lt;</span>string<span class="token operator">></span>
    <span class="token punctuation">)</span> <span class="token operator">:</span> array<span class="token operator">&lt;</span>string<span class="token operator">></span><span class="token punctuation">;</span>

    <span class="token comment">//////////////////</span>
    <span class="token comment">//  Arithmetic  //</span>
    <span class="token comment">//////////////////</span>

    <span class="token comment">/** Returns input plus duration according to the calendar rules. */</span>
    <span class="token function">dateAdd</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">,</span>
        <span class="token literal-property property">duration</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Duration<span class="token punctuation">,</span>
        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token comment">/* options bag */</span><span class="token punctuation">,</span>
        <span class="token function-variable function">constructor</span><span class="token operator">:</span> <span class="token keyword">function</span>
    <span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">;</span>

    <span class="token comment">/** Returns input minus duration according to the calendar rules. */</span>
    <span class="token function">dateSubtract</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">,</span>
        <span class="token literal-property property">duration</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Duration<span class="token punctuation">,</span>
        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token comment">/* options bag */</span><span class="token punctuation">,</span>
        <span class="token function-variable function">constructor</span><span class="token operator">:</span> <span class="token keyword">function</span>
    <span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">;</span>

    <span class="token comment">/** Returns larger minus smaller, which are dates in the same calendar. */</span>
    <span class="token function">dateUntil</span><span class="token punctuation">(</span>
        <span class="token literal-property property">smaller</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">,</span>
        <span class="token literal-property property">larger</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">,</span>
        <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token comment">/* options bag */</span>
    <span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Duration<span class="token punctuation">;</span>

    <span class="token comment">////////////////////////////////////</span>
    <span class="token comment">//  Accessors:                    //</span>
    <span class="token comment">//  Semantics defined in date.md  //</span>
    <span class="token comment">////////////////////////////////////</span>

    <span class="token function">year</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate
    <span class="token punctuation">)</span> <span class="token operator">:</span> number<span class="token punctuation">;</span>

    <span class="token function">month</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate
    <span class="token punctuation">)</span> <span class="token operator">:</span> number<span class="token punctuation">;</span>

    <span class="token function">day</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate
    <span class="token punctuation">)</span> <span class="token operator">:</span> number<span class="token punctuation">;</span>

    <span class="token function">dayOfWeek</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate
    <span class="token punctuation">)</span> <span class="token operator">:</span> number<span class="token punctuation">;</span>

    <span class="token function">weekOfYear</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate
    <span class="token punctuation">)</span> <span class="token operator">:</span> number<span class="token punctuation">;</span>

    <span class="token function">daysInMonth</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate
    <span class="token punctuation">)</span> <span class="token operator">:</span> number<span class="token punctuation">;</span>

    <span class="token function">daysInYear</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate
    <span class="token punctuation">)</span> <span class="token operator">:</span> number<span class="token punctuation">;</span>

    <span class="token function">inLeapYear</span><span class="token punctuation">(</span>
        <span class="token literal-property property">input</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate
    <span class="token punctuation">)</span> <span class="token operator">:</span> boolean<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>The corresponding fields on Temporal.PlainDate.prototype should forward requests to the calendar as discussed in <a href="https://github.com/tc39/proposal-temporal/issues/291">#291</a>:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">get</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>calendar<span class="token punctuation">.</span>foo<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><p>Calendars can add additional <em>calendar-specific accessors</em>, such as the year type (&quot;kesidran&quot;, &quot;chaser&quot;, &quot;maleh&quot;) in the Hebrew calendar, and may add conforming accessor methods to Temporal.PlainDate.prototype.</p>
<p>If any of these accessors are needed for constructing a Temporal.PlainDate from fields, then the calendar should implement <code>fields()</code> which, given an array of field names in the ISO calendar, returns an array of equivalent field names in the calendar.
We are not aware of this being necessary for any built-in calendars.</p>
<p>An instance of <code>MyCalendar</code> is <em>expected</em> to have stateless behavior; i.e., calling a method with the same arguments should return the same result each time. There would be no mechanism for enforcing that user-land calendars are stateless; the calendar author should test this expectation on their own in order to prevent unexpected behavior such as the lack of round-tripping.</p>
<h3 id="enumerable-properties"><a class="heading-link" href="#enumerable-properties"></a>Enumerable Properties</h3><p>Main issue: <a href="https://github.com/tc39/proposal-temporal/issues/403">https://github.com/tc39/proposal-temporal/issues/403</a></p>
<p>If properties of Temporal.PlainDate, etc., are to be enumerable, the calendar should choose which properties to expose. This operation can cake place in the factory methods of the Temporal.Calendar protocol, such as <code>.dateFromFields()</code>.</p>
<p>This is a work in progress, and this document will be updated once we reach consensus on #403.</p>
<h2 id="default-calendar"><a class="heading-link" href="#default-calendar"></a>Default Calendar</h3><p>Main issue: <a href="https://github.com/tc39/proposal-temporal/issues/292">https://github.com/tc39/proposal-temporal/issues/292</a></p>
<p>An open question is what the behavior should be if the programmer does not specify a calendar, or if we should require the programmer to always specify a calendar. Six choices are on the table:</p>
<ol>
<li>Default to full ISO (Gregorian) calendar.</li>
<li>Require the user to explicitly specify the calendar.</li>
<li>Default to a partial ISO calendar (explained below).</li>
<li>Default to <code>Intl.defaultCalendar</code> (a new symbol), or ISO if that field doesn&#39;t exist.</li>
<li>Create separate types for when a calendar is not present (explained below).</li>
<li>Add factory methods for ISO and non-ISO (explained below).</li>
</ol>
<p><strong>As of October 2020, the Temporal champions chose to adopt Option 6 as the best balance between i18n correctness and ergonomics.</strong></p>
<h3 id="partial-iso-calendar-option-3"><a class="heading-link" href="#partial-iso-calendar-option-3"></a>Partial ISO Calendar (Option 3)</h3><p>A partial ISO calendar would be one implemented as follows:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> PartialIsoCalendar <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">"iso"</span><span class="token punctuation">,</span>

    <span class="token function">dateFromFields</span><span class="token punctuation">(</span><span class="token parameter">fields<span class="token punctuation">,</span> constructor</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day <span class="token punctuation">}</span> <span class="token operator">=</span> fields<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">constructor</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Same for dateTimeFromFields, etc.</span>

    <span class="token comment">// ALL OTHER METHODS:</span>
    <span class="token function">dateAdd</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">"Unsupported operation: full calendar required"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Same for subtract, etc.</span>
<span class="token punctuation">}</span></code></pre><p>It would in effect render default Temporal.PlainDate (and Temporal.PlainDateTime) with fewer operations until you specify a calendar. The following methods/getters would throw:</p>
<ul>
<li>.dayOfWeek</li>
<li>.weekOfYear</li>
<li>.daysInMonth</li>
<li>.daysInYear</li>
<li>.inLeapYear</li>
<li>.year</li>
<li>.month</li>
<li>.day</li>
<li>.add()*</li>
<li>.subtract()*</li>
<li>.since()*</li>
<li>.getYearMonth()</li>
<li>.getMonthDay()</li>
<li>.with()</li>
</ul>
<p>* <em>We could allow the arithmetic methods to work in Partial ISO if the duration units are days or smaller, with the same semantics as Temporal.Instant.</em></p>
<p>The following methods/getters would still work:</p>
<ul>
<li>.inTimeZone()</li>
<li>.withTime()</li>
<li>.toString()</li>
<li>.toLocaleString()</li>
<li>.compare()</li>
</ul>
<p>Although small, this set of operations still covers many of the recipes in the proposed Temporal Cookbook.</p>
<p>To enable the extended set of operations, the user would just use <code>.withCalendar()</code>:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Force the Gregorian calendar:</span>
Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'2019-12-06'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span><span class="token string">'gregory'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>weekOfYear<span class="token punctuation">;</span>

<span class="token comment">// Use a calendar from another source:</span>
Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'2019-12-06'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>Intl<span class="token punctuation">.</span>defaultCalendar<span class="token punctuation">)</span><span class="token punctuation">.</span>weekOfYear<span class="token punctuation">;</span>
Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'2019-12-06'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span>calendar<span class="token punctuation">)</span><span class="token punctuation">.</span>weekOfYear<span class="token punctuation">;</span></code></pre><p>The calendar IDs are less clear. If the partial ISO calendar used ID <code>&quot;iso&quot;</code>, then what would the full ISO calendar use? ID &quot;gregory&quot; (<a href="https://github.com/tc39/ecma402/issues/212">why not &quot;gregorian&quot;?</a>) is misleading because there are Gregorian calendars that do not all agree on the same rules for things like weeks of the year. One solution could be to use a nullish ID like <code>null</code> or <code>&quot;&quot;</code> for the partial ISO calendar and <code>&quot;iso&quot;</code> for the full ISO calendar. Alternatively, &quot;iso8601&quot;, the identifier defined by CLDR as &quot;Gregorian calendar using the ISO 8601 calendar week rules&quot;, could be the identifier for the full ISO calendar.</p>
<h3 id="new-non-calendar-types-option-5"><a class="heading-link" href="#new-non-calendar-types-option-5"></a>New Non-Calendar Types (Option 5)</h3><p>In this option, objects without a calendar would have their own type, and calendar-specific types would be used only when calendar-dependent functionality is required. This is similar in spirit to Partial ISO (Option 3), except that new types are used, rather than simply a null calendar on the existing type.</p>
<p>For example, name bikeshedding aside, <code>Temporal.ZonedAbsolute</code> (main issue: <a href="https://github.com/tc39/proposal-temporal/issues/569">#569</a>) could become an intermediate type between <code>Temporal.Instant</code> and <code>Temporal.PlainDateTime</code> that does not include arithmetic or calendar-dependent functionality. A calendar would be necessary when converting from <code>Temporal.ZonedAbsolute</code> into <code>Temporal.PlainDateTime</code>.</p>
<ul>
<li><code>Temporal.Instant</code> = a point in time, not specific to a certain place. - Data Model: [[EpochNanoseconds]]</li>
<li><code>Temporal.ZonedAbsolute</code> = a point in time at a place on Earth. - Data Model: [[EpochNanoseconds]] + [[TimeZone]]</li>
<li><code>Temporal.PlainDateTime</code> = a wall clock time, not specific to a certain place. - Data Model: [[Calendar]] + ISO fields</li>
</ul>
<p>Conversion methods between these three types could be:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Absolute &lt;=> ZonedAbsolute</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">Instant</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">withZone</span><span class="token punctuation">(</span>tz<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>ZonedAbsolute<span class="token punctuation">;</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">ZonedAbsolute</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>Instant<span class="token punctuation">;</span>

<span class="token comment">// ZonedAbsolute &lt;=> DateTime</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">ZonedAbsolute</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>cal<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDateTime<span class="token punctuation">;</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDateTime</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">withZone</span><span class="token punctuation">(</span>tz<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>ZonedAbsolute<span class="token punctuation">;</span></code></pre><p>We could add a similar intermediate type for dates without times. Name bikeshedding aside, this second new type could be <code>Temporal.AbstractDate</code>. The semantics would be:</p>
<ul>
<li><code>Temporal.AbstractDate</code> = a solar day at a place on Earth - Data Model: [[EpochDays]] + [[TimeZone]]</li>
<li><code>Temporal.PlainDate</code> = a wall clock date, not specific to a certain place. - Data Model: [[Calendar]] + ISO fields</li>
</ul>
<p>Conversion methods:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// ZonedAbsolute &lt;=> AbstractDate</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">ZonedAbsolute</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>AbstractDate<span class="token punctuation">;</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">AbstractDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">withTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>ZonedAbsolute<span class="token punctuation">;</span>

<span class="token comment">// AbstractDate &lt;=> Date</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">AbstractDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>cal<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">;</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">withZone</span><span class="token punctuation">(</span>tz<span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>AbstractDate<span class="token punctuation">;</span>

<span class="token comment">// Date &lt;=> DateTime</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDateTime</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">getDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">;</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">withTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDateTime<span class="token punctuation">;</span></code></pre><p>An additional type, <code>Temporal.EpochDays</code>, could be added as an analog of <code>Temporal.Instant</code> but with days instead of nanoseconds since epoch.</p>
<p>Here is an illustrated version of this option:</p>
<p><img src="assets/new-data-types.svg" alt="Potential Temporal Data Types"></p>
<h3 id="new-factory-methods-option-6"><a class="heading-link" href="#new-factory-methods-option-6"></a>New Factory Methods (Option 6)</h3><p>With this option, separate methods would indicate whether the Full ISO calendar should be used versus a potentially non-ISO calendar. For example, <code>Temporal.Now.plainDateISO</code> would be added to supplement <code>Temporal.Now.plainDate</code>. See the full table below.</p>
<h3 id="methods-of-construction"><a class="heading-link" href="#methods-of-construction"></a>Methods of Construction</h3><p>The main way the six options differ is by how and when a calendar is specified when creating calendar-sensitive Temporal objects.</p>
<p>The following table describes these semantics. Option 5 is not shown because the constructors will be different than in options 1-4 and 6.</p>
<table>
<thead>
<tr>
<th>Method</th>
<th>Option 1</th>
<th>Option 2</th>
<th>Option 3</th>
<th>Option 4</th>
<th>Option 6</th>
</tr>
</thead>
<tbody><tr>
<td>T.Date.from(string)*</td>
<td><em>From String</em></td>
<td>Explicit</td>
<td>Partial ISO</td>
<td>Environ.</td>
<td><em>From String</em></td>
</tr>
<tr>
<td>T.Date.from(fields)**</td>
<td><em>From Object</em></td>
<td>Explicit</td>
<td>Partial ISO</td>
<td>Environ.</td>
<td><em>From Object</em></td>
</tr>
<tr>
<td>new T.Date()</td>
<td>Full ISO</td>
<td>Full ISO</td>
<td>Full ISO</td>
<td>Full ISO</td>
<td>Full ISO</td>
</tr>
<tr>
<td>T.Now.plainDate()</td>
<td>Full ISO</td>
<td>Explicit</td>
<td>Partial ISO</td>
<td>Environ.</td>
<td>Explicit</td>
</tr>
<tr>
<td>T.Now.plainDateISO()</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>Full ISO</td>
</tr>
<tr>
<td>instant.inTimeZone()</td>
<td>Full ISO</td>
<td>Explicit</td>
<td>Partial ISO</td>
<td>Environ.</td>
<td>Explicit</td>
</tr>
<tr>
<td>instant.inZoneISO()</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>Full ISO</td>
</tr>
<tr>
<td>date.getMonthDay()****</td>
<td>Inherit</td>
<td>Inherit</td>
<td>Explicit</td>
<td>Inherit</td>
<td>Inherit</td>
</tr>
<tr>
<td>HTML input***</td>
<td>Full ISO</td>
<td>Full ISO</td>
<td>Full ISO</td>
<td>Full ISO</td>
<td>Full ISO</td>
</tr>
</tbody></table>
<p>Footnotes:</p>
<p>* from(string) may carry the calendar ID in the string (main issue: <a href="https://github.com/tc39/proposal-temporal/issues/293">#293</a>).</p>
<p>** @ptomato <a href="https://github.com/tc39/proposal-temporal/pull/590#discussion_r427527732">pointed out</a> that &quot;if you write Temporal.PlainDate.from({ year: 2020, month: 5, day: 19 }) with no calendar specified, then realistically what else do you mean besides the full ISO calendar?&quot; Therefore, a calendar argument is not required in T.Date.from.</p>
<p>*** The HTML5 spec only supports ISO-8601 (<a href="https://html.spec.whatwg.org/multipage/common-microsyntaxes.html#concept-date">reference</a>).</p>
<p>**** An argument could be added to <code>getMonthDay()</code> in Options 3 and 5 to reduce boilerplate.</p>
<h3 id="preventing-i18n-errors"><a class="heading-link" href="#preventing-i18n-errors"></a>Preventing I18n Errors</h3><p>As compared to option 1 (always default to Full ISO), the following are examples of programming errors that Partial ISO would help prevent.</p>
<p>These errors are most common in the four regions that use non-ISO calendars as their default: Saudi Arabia, Iran, Afghanistan, and Thailand. However, they could also manifest if the user has overridden their preferred calendar in browser settings.</p>
<p>For the purposes of illustration, the following examples will use the locale &quot;en-SA&quot; (English in Saudi Arabia) on 2020-05-17.</p>
<h4 id="format-a-month-and-day-from-a-date"><a class="heading-link" href="#format-a-month-and-day-from-a-date"></a>Format a month and day from a date</h3><p>Buggy output:</p>
<pre><code>Today is: May 17</code></pre><p>Correct output:</p>
<pre><code>Today is: Ramadan 24</code></pre><p>Code:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">/// Options 1 and 4: calendar implicit</span>
<span class="token keyword">const</span> today <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// OPTION 1 BUG: the ISO calendar is implicit when creating the MonthDay</span>
<span class="token keyword">const</span> monthDay <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">getMonthDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> monthDay<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Options 2 and 6: calendar in factory method</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> today <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> monthDay <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">getMonthDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> monthDay<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Option 3 and 5: getMonthDay() requires a calendar to be given</span>
<span class="token keyword">const</span> today <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> monthDay <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMonthDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> monthDay<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Option 3 and 5 alternative: add argument to getMonthDay()</span>
<span class="token keyword">const</span> today <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> monthDay <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">getMonthDay</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> monthDay<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Alternative using Intl settings</span>
<span class="token keyword">const</span> today <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
  <span class="token string">'Today is:'</span><span class="token punctuation">,</span>
  today<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">month</span><span class="token operator">:</span> <span class="token string">'long'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">day</span><span class="token operator">:</span> <span class="token string">'numeric'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="get-this-date-next-month"><a class="heading-link" href="#get-this-date-next-month"></a>Get this date next month</h3><p>Buggy output:</p>
<pre><code>Today is: Ramadan 24, 1441 AH
Next month is: Shawwal 25, 1441 AH</code></pre><p>Correct output:</p>
<pre><code>Today is: Ramadan 24, 1441 AH
Next month is: Shawwal 24, 1441 AH</code></pre><p>Code:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">/// Options 1 and 4: calendar implicit</span>
<span class="token keyword">const</span> today <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> today<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// OPTION 1 BUG:</span>
<span class="token comment">// Arithmetic in months must take place in the user calendar</span>
<span class="token keyword">const</span> nextMonth <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">months</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Next month is: '</span><span class="token punctuation">,</span> nextMonth<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Options 2 and 6: calendar in factory method</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> today <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> today<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nextMonth <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">months</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Next month is: '</span><span class="token punctuation">,</span> nextMonth<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Options 3 and 5: calendar only when needed</span>
<span class="token keyword">const</span> today <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> today<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nextMonth <span class="token operator">=</span> today<span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">months</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Next month is: '</span><span class="token punctuation">,</span> nextMonth<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="get-a-month-and-a-day"><a class="heading-link" href="#get-a-month-and-a-day"></a>Get a month and a day</h3><p>Buggy output:</p>
<pre><code>Today is: Ramadan 24, 1441 AH
Is May 18 your birthday?</code></pre><p>Correct output:</p>
<pre><code>Today is: Ramadan 24, 1441 AH
Is Ramadan 24 your birthday?</code></pre><p>Code:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">/// Options 1 and 4: calendar implicit</span>
<span class="token keyword">const</span> date <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> date<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// OPTION 1 BUG:</span>
<span class="token comment">// The MonthDay needs to be represented in the user calendar; otherwise,</span>
<span class="token comment">// toLocaleString must format in the ISO calendar.</span>
<span class="token keyword">const</span> monthDay <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMonthDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>monthDay<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> your birthday?</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Options 2 and 6: calendar in factory method</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> date <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> date<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> monthDay <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getMonthDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>monthDay<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> your birthday?</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Options 3 and 5: calendar only when needed</span>
<span class="token keyword">const</span> date <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> date<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> monthDay <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMonthDay</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>monthDay<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> your birthday?</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h4 id="get-a-month-related-property"><a class="heading-link" href="#get-a-month-related-property"></a>Get a month-related property</h3><p>Buggy output:</p>
<pre><code>Today is: Ramadan 24, 1441 AH
Number of days this month: 31</code></pre><p>Correct output:</p>
<pre><code>Today is: Ramadan 24, 1441 AH
Number of days this month: 30</code></pre><p>Code:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">/// Options 1 and 4: calendar implicit</span>
<span class="token keyword">const</span> date <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// OPTION 1 BUG:</span>
<span class="token comment">// The YearMonth needs to be represented in the user calendar</span>
<span class="token keyword">const</span> yearMonth <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getYearMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> date<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Number of days this month:'</span><span class="token punctuation">,</span> yearMonth<span class="token punctuation">.</span>daysInMonth<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Options 2 and 6: calendar in factory method</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> date <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> yearMonth <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getYearMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> date<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Number of days this month:'</span><span class="token punctuation">,</span> yearMonth<span class="token punctuation">.</span>daysInMonth<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/// Options 3 and 5: calendar only when needed</span>
<span class="token keyword">const</span> date <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">plainDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> calendar <span class="token operator">=</span> navigator<span class="token punctuation">.</span>locales<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getLikelyCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> yearMonth <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getYearMonth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Today is:'</span><span class="token punctuation">,</span> date<span class="token punctuation">.</span><span class="token function">toLocaleString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Number of days this month:'</span><span class="token punctuation">,</span> yearMonth<span class="token punctuation">.</span>daysInMonth<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><h3 id="default-calendar-options-pros-and-cons"><a class="heading-link" href="#default-calendar-options-pros-and-cons"></a>Default Calendar Options: Pros and Cons</h3><p>Legend:</p>
<ul>
<li>ð = Strong advantage</li>
<li>ð = Mixed advantage</li>
<li>ð = Surmountable disadvantage</li>
<li>â¹ï¸ = Insurmountable disadvantage</li>
</ul>
<table>
<thead>
<tr>
<th>Option</th>
<th>API consistency &amp; predictability</th>
<th>Impact on Temporal call sites</th>
<th>Impact on i18n correctness</th>
<th>Impact on interoperability</th>
<th>Logistics</th>
</tr>
</thead>
<tbody><tr>
<td>Full ISO (option 1)</td>
<td>ð Consistent and predictable</td>
<td>ð No changes</td>
<td>â¹ï¸ Programmer needs to know to &quot;opt in&quot; to use the user&#39;s calendar preference</td>
<td>ð ISO is the industry standard format</td>
<td>ð No changes</td>
</tr>
<tr>
<td>No Default (option 2)</td>
<td>ð Consistent and predictable</td>
<td>ð All call sites require extra boilerplate</td>
<td>ð All operations require an explicit choice</td>
<td>ð Explicit choice</td>
<td>ð Minimal API changes</td>
</tr>
<tr>
<td>Partial ISO (option 3)</td>
<td>ð Predictable behavior, but call sites may or may not require an explicit calendar</td>
<td>ð Most* operations work; some require extra boilerplate</td>
<td>ð Calendar-sensitive operations require an explicit choice</td>
<td>ð I/O operations operate in the ISO calendar space</td>
<td>ð No API changes, but edge cases to hash out</td>
</tr>
<tr>
<td>User Preference (option 4)</td>
<td>ð Consistent API, but unpredictable behavior based on user&#39;s or server&#39;s location</td>
<td>ð No changes</td>
<td>ð Correct on front end, but programmer needs to know to &quot;opt in&quot; on back end</td>
<td>ð Certain operations implicitly use a non-ISO calendar</td>
<td>ð Minimal API changes</td>
</tr>
<tr>
<td>New Types (option 5)</td>
<td>ð Consistent, but the new types may increase mental load</td>
<td>ð Most* operations work; some require extra boilerplate</td>
<td>ð Calendar-sensitive operations require an explicit choice</td>
<td>ð I/O operations operate in the ISO calendar space</td>
<td>ð Lots of new types and API changes</td>
</tr>
<tr>
<td>ISO Factories (option 6)</td>
<td>ð Unclear whether to use ISO or non-ISO factories</td>
<td>ð Method names at call sites may change</td>
<td>ð Likely to be correct, but users could call the ISO factories incorrectly</td>
<td>ð ISO-specific methods for interop</td>
<td>ð Minimal API changes</td>
</tr>
</tbody></table>
<p>*<em>See <a href="https://github.com/tc39/proposal-temporal/issues/240#issuecomment-557726669">https://github.com/tc39/proposal-temporal/issues/240#issuecomment-557726669</a></em></p>
<h2 id="temporalplaindate-api-changes"><a class="heading-link" href="#temporalplaindate-api-changes"></a>Temporal.PlainDate API changes</h3><h3 id="new-temporalplaindate-instance-methods"><a class="heading-link" href="#new-temporalplaindate-instance-methods"></a>New Temporal.PlainDate instance methods</h3><p>Temporal.PlainDate.prototype.with does <em>not</em> modify the calendar. A new method is added for that:</p>
<pre class="language-javascript"><code class="language-javascript">Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">withCalendar</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">newCalendar</span><span class="token operator">:</span> Calendar</span><span class="token punctuation">)</span><span class="token operator">:</span> Temporal<span class="token punctuation">.</span>PlainDate <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getISOFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// note: call intrinsic version</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Temporal<span class="token punctuation">.</span>PlainDate</span><span class="token punctuation">(</span>year<span class="token punctuation">,</span> month<span class="token punctuation">,</span> day<span class="token punctuation">,</span> newCalendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// note: use species constructor</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h3 id="iso-strings-with-calendar-hint"><a class="heading-link" href="#iso-strings-with-calendar-hint"></a>ISO strings with calendar hint</h3><p>This is an open question being discussed in <a href="https://github.com/tc39/proposal-temporal/issues/293">#293</a>. The issue is that we do not want <code>toString()</code> to be lossy by losing the <code>calendar</code> field. One proposal is to append the <code>Temporal.Calendar.id</code> field in <code>[c=ID]</code> following the date. For example, <code>2019-12-06[c=hebrew]</code> refers to 2019-12-06 projected into the Hebrew calendar.</p>
<pre class="language-javascript"><code class="language-javascript">Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">toString</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> calendarKeyword<span class="token punctuation">,</span> isoDate<span class="token punctuation">;</span>
    <span class="token comment">// For Default Calendar Option 3, check for the partial ISO calendar here</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token comment">/* this.calendar is the ISO calendar */</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        calendarKeyword <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        isoDate <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        calendarKeyword <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>calendar<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
        isoDate <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>Temporal<span class="token punctuation">.</span>Calendar<span class="token punctuation">.</span>iso<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// call intrinsic</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// return an ISO string for isoDate with calendar in brackets:</span>
    <span class="token comment">// "2019-12-06[c=hebrew]"</span>
<span class="token punctuation">}</span></code></pre><p>In this scenario, <code>Temporal.PlainDate.from()</code> will call <code>Temporal.Calendar.from()</code> to resolve the ID into a Calendar object.
<code>Temporal.parse()</code> will have to add a new <code>calendar</code> member to the object it returns, whose value is the string ID given in a <code>[c=ID]</code> comment, or <code>null</code> if not given.</p>
<p><code>Temporal.Calendar.from()</code> can be monkeypatched by calendar implementors if it is necessary to make new time zones available globally.
The expectation is that it would rarely be necessary to do so, because if you have implemented a custom calendar for a particular application, you probably don&#39;t need it to be available globally.</p>
<p>Example of monkeypatching for a custom calendar:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> fooCalendar <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FooCalendar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> originalTemporalCalendarFrom <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Calendar<span class="token punctuation">.</span>from<span class="token punctuation">;</span>
Temporal<span class="token punctuation">.</span>Calendar<span class="token punctuation">.</span><span class="token function-variable function">from</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> id<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>item <span class="token keyword">instanceof</span> <span class="token class-name">Temporal<span class="token punctuation">.</span>Calendar</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token punctuation">{</span> id <span class="token punctuation">}</span> <span class="token operator">=</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> string <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>item<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      id <span class="token operator">=</span> Temporal<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">.</span>calendar<span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">{</span>
      id <span class="token operator">=</span> string<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">===</span> <span class="token string">'foo'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> fooCalendar<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token function">originalTemporalCalendarFrom</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> item<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">'2019-12-03[c=foo]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 2019-12-03 projected into the foo calendar</span></code></pre><h3 id="new-behavior-of-temporalplaindatefrom"><a class="heading-link" href="#new-behavior-of-temporalplaindatefrom"></a>New behavior of Temporal.PlainDate.from</h3><p>The exact behavior of this method depends on a few open discussions, but some logic will be passed to the Calendar object in order to project the date into the correct calendar system.</p>
<pre class="language-javascript"><code class="language-javascript">Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">.</span><span class="token function-variable function">from</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">thing</span><span class="token operator">:</span> string <span class="token operator">|</span> object<span class="token punctuation">,</span> <span class="token literal-property property">options</span><span class="token operator">:</span> object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> thing <span class="token operator">===</span> <span class="token string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> object <span class="token operator">=</span> <span class="token comment">// components of string</span>
        <span class="token keyword">return</span> Temporal<span class="token punctuation">.</span>Calendar<span class="token punctuation">.</span>iso<span class="token punctuation">.</span><span class="token function">dateFromFields</span><span class="token punctuation">(</span>object<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// Get the calendar object, either the default calendar or something based</span>
        <span class="token comment">// on thing.calendar (string lookup or object)</span>
        <span class="token keyword">let</span> calendar <span class="token operator">=</span> <span class="token comment">// ...</span>
        <span class="token keyword">return</span> calendar<span class="token punctuation">.</span><span class="token function">dateFromFields</span><span class="token punctuation">(</span>thing<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="semantics-of-existing-temporalplaindate-instance-methods"><a class="heading-link" href="#semantics-of-existing-temporalplaindate-instance-methods"></a>Semantics of existing Temporal.PlainDate instance methods</h3><p>As discussed earlier, Temporal.PlainDate will defer to Temporal.Calendar methods wherever necessary. Example implementation of selected Temporal.PlainDate methods:</p>
<pre class="language-javascript"><code class="language-javascript">Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">duration<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> constructor <span class="token operator">=</span> <span class="token constant">ES</span><span class="token punctuation">.</span><span class="token function">SpeciesConstructor</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> Temporal<span class="token punctuation">.</span>PlainDate<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>calendar<span class="token punctuation">.</span><span class="token function">dateAdd</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> duration<span class="token punctuation">,</span> options<span class="token punctuation">,</span> constructor<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">until</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">other<span class="token punctuation">,</span> options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span>calendar <span class="token operator">!==</span> <span class="token keyword">this</span><span class="token punctuation">.</span>calendar<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Note: call intrinsic versions of this method</span>
    other <span class="token operator">=</span> other<span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>calendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>calendar<span class="token punctuation">.</span><span class="token function">dateUntil</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> other<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">with</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">overrides</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> newFields <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> overrides<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>calendar<span class="token punctuation">.</span><span class="token function">dateFromFields</span><span class="token punctuation">(</span>newFields<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

Temporal<span class="token punctuation">.</span><span class="token class-name">PlainDate</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">getYearMonth</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>calendar<span class="token punctuation">.</span><span class="token function">yearMonthFromFields</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getFields</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p>Note that the arguments to methods like <code>with</code>, <code>withDate</code>, etc., are interpreted in the instance&#39;s calendar.</p>
<h2 id="other-temporalplaindate-constructors"><a class="heading-link" href="#other-temporalplaindate-constructors"></a>Other Temporal.PlainDate constructors</h3><h3 id="temporalinstantprototypeintimezone"><a class="heading-link" href="#temporalinstantprototypeintimezone"></a>Temporal.Instant.prototype.inTimeZone</h3><p>The third way to get a Temporal.PlainDate (besides from a string and an object) is to convert it from a Temporal.Instant.</p>
<p>The API here would depend on the decision for whether to require an explicit default calendar. If we decide to use a default calendar (options 1, 3, and 4), no API change would be required for this method. If we decide to require an explicit calendar, then the API would likely be changed as follows:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token comment">// Default calendar option 2 only</span>
Temporal<span class="token punctuation">.</span><span class="token class-name">Instant</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">inTimeZone</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">timeZone<span class="token punctuation">,</span> calendar</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> isoDate <span class="token operator">=</span> <span class="token comment">// compute the ISO date from the time zone</span>
    <span class="token keyword">return</span> isoDate<span class="token punctuation">.</span><span class="token function">withCalendar</span><span class="token punctuation">(</span>calendar<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h3 id="temporalnow"><a class="heading-link" href="#temporalnow"></a>Temporal.Now</h3><p>The fourth way to get a Temporal.PlainDate is to get the current time according to the environment (or mocked for SES).</p>
<p>As above, this API depends on whether we decide to use a default calendar. If we require an explicit calendar, it would be similar to above:</p>
<pre class="language-javascript"><code class="language-javascript">Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function-variable function">plainDate</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">calendar</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> instant <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">instant</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// use intrinsic</span>
  <span class="token keyword">const</span> timeZone <span class="token operator">=</span> Temporal<span class="token punctuation">.</span>Now<span class="token punctuation">.</span><span class="token function">timeZone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// use intrinsic</span>
  <span class="token keyword">return</span> instant<span class="token punctuation">.</span><span class="token function">inTimeZone</span><span class="token punctuation">(</span>timeZone<span class="token punctuation">,</span> calendar<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// use intrinsic</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><h2 id="changes-to-other-temporal-apis"><a class="heading-link" href="#changes-to-other-temporal-apis"></a>Changes to other Temporal APIs</h3><p>All of the following APIs would gain an internal slot for the calendar.</p>
<ul>
<li>Temporal.PlainDateTime</li>
<li>Temporal.PlainTime</li>
<li>Temporal.PlainYearMonth</li>
<li>Temporal.PlainMonthDay</li>
</ul>
<h3 id="new-behavior-of-temporalplainmonthdaywithyear"><a class="heading-link" href="#new-behavior-of-temporalplainmonthdaywithyear"></a>New behavior of Temporal.PlainMonthDay.withYear</h3><p>In some calendars (such as the Japanese imperial calendar) a year is not enough information to be able to convert Temporal.PlainMonthDay to Temporal.PlainDate.
Temporal.PlainMonthDay.withYear, which previously took a number argument (the year), can now be passed an object which must have properties that provide the needed information.
(In the Japanese calendar, it needs to have <code>era</code> and <code>year</code> properties.)</p>
<p>Passing a numerical year argument <code>num</code> is equivalent to passing <code>{ year: num }</code>.
The calendar can decide what to do in the case of missing information, in <code>dateFromFields</code>.</p>
    <footer>
      <p>
        This page includes a script which loads an implementation of Temporal in your browser.
        You can open a console in your browser's developer tools and try it out directly!
      </p>
      <p>View this or help contribute on <a href="https://github.com/tc39/proposal-temporal">GitHub</a>.</p>
    </footer>
  </body>
</html>
