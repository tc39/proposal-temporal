<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Temporal documentation</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/light.min.css">
    <script type="application/javascript" src="./playground.js"></script>
    <link rel="stylesheet" type="text/css" href="./prism.css">
    <script>
      Temporal = { ...temporal.Temporal };
      Object.assign(Intl, temporal.Intl);

      // Customize output of Temporal objects for Chrome DevTools
      if (!window.devtoolsFormatters)
        window.devtoolsFormatters = [];
      window.devtoolsFormatters.push({
        header(x) {
          for (const type of [
            Temporal.Instant,
            Temporal.Calendar,
            Temporal.PlainDate,
            Temporal.PlainDateTime,
            Temporal.Duration,
            Temporal.PlainMonthDay,
            Temporal.PlainTime,
            Temporal.TimeZone,
            Temporal.PlainYearMonth
          ]) {
            if (x instanceof type) return ['span', {}, `${x[Symbol.toStringTag]} <${x}>`];
          }
          return null;
        },
        hasBody(x) {
          return x instanceof Temporal.Duration;
        },
        body(x) {
          const out = ['ol', { style: 'list-style-type: none;' }];
          for (const prop of [
            'years',
            'months',
            'weeks',
            'days',
            'hours',
            'minutes',
            'seconds',
            'milliseconds',
            'microseconds',
            'nanoseconds'
          ]) {
            if (x[prop] !== 0) out.push([
              'li',
              {},
              ['span', { style: 'color: purple;' }, prop],
              `: `,
              ['span', { style: 'color: blue;' }, x[prop]]
            ]);
          }
          return out;
        }
      });
    </script>
    <style>
      /* https://github.com/kognise/water.css/blob/master/src/variables-light.css */
      :root {
        --background: #efefef;
        --text-muted: #999999;
        --text-bright: #000000;
        --text-width: 900px;
        --variable: #39a33c;
      }
      body {
        font-size: 18px;
        max-width: var(--text-width);
        padding-top: 40px;  /* extra padding for banner */
        line-height: 1.5;
      }
      pre { border-left: 4px solid var(--variable); }
      code {
        padding: 1px 5px 2px 5px;
        line-height: 1.1;
        display: inline-block;
      }
      pre code { line-height: 1.4; }
      pre code[class*="language-"] { font-size: 0.85em; }
      pre[class*="language-"] { padding: 0.5em; }
      h1 { margin-top: 13px; }
      h2 { border-bottom: 2px solid var(--text-muted); margin-top: 2em; }
      h3 {
        border-bottom: 1px solid var(--text-muted);
        color: var(--text-muted);
        font-weight: normal;
      }
      h3 em { font-weight: bold; }
      h3 strong { color: var(--text-bright); }
      :not(h2) + h3 { margin-top: 2em; }
      footer {
        border-top: 1px solid var(--background);
        color: var(--text-muted);
        font-size: 0.8em;
        margin-top: 2em;
        padding-top: 10px;
      }
      .heading-link {
        left: calc((100vw - var(--text-width)) / 2 - 1.5em);
        opacity: 0;
        position: absolute;
        transition: opacity 150ms;
      }
      .heading-link:hover { text-decoration: none; }
      .heading-link::before { content: '¶'; }
      h3:hover .heading-link { opacity: 1; }
      .banner {
        /* Gradient from https://joshnh.com/weblog/how-to-make-an-alert-bar/ */
        background-color: #fce94f;
        background-image: linear-gradient(135deg,
                                          transparent,
                                          transparent 25%,
                                          rgba(0, 0, 0, .05) 25%,
                                          rgba(0, 0, 0, .05) 50%,
                                          transparent 50%,
                                          transparent 75%,
                                          rgba(0, 0, 0, .05) 75%,
                                          rgba(0, 0, 0, .05));
        background-size: 20px 20px;
        box-shadow: 0 5px 0 rgba(0, 0, 0, .1);
        left: 0;
        padding: 0.4em 0;
        position: absolute;
        text-align: center;
        top: 0;
        width: 100%;
      }
    </style>
  </head>
  <body>
    <div class="banner">
      This proposal is <strong><a href="https://blogs.igalia.com/compilers/2020/06/23/dates-and-times-in-javascript/">experimental.</a></strong>
      The API will change based on feedback that we get.
      <strong>Do</strong> <a href="https://forms.gle/iL9iZg7Y9LvH41Nv8">give feedback</a> and open <a href="https://github.com/tc39/proposal-temporal/issues">issues</a>; <strong>don't</strong> use it in production!
    </div>
<h1 id="temporal-cookbook">Temporal Cookbook</h1>
<h2 id="overview">Overview</h2>
<ul>
<li><a href="#overview">Overview</a>
</li>
<li><a href="#running-the-cookbook-files">Running the cookbook files</a>
</li>
<li><a href="#frequently-asked-questions">Frequently Asked Questions</a>
<ul>
<li><a href="#current-date-and-time">Current date and time</a>
</li>
<li><a href="#unix-timestamp">Unix timestamp</a>
</li>
</ul>
</li>
<li><a href="#converting-between-temporal-types-and-legacy-date">Converting between Temporal types and legacy Date</a>
<ul>
<li><a href="#instant-from-legacy-date">Instant from legacy Date</a>
</li>
</ul>
</li>
<li><a href="#construction">Construction</a>
<ul>
<li><a href="#time-zone-object-from-name">Time zone object from name</a>
</li>
<li><a href="#calendar-input-element">Calendar input element</a>
</li>
</ul>
</li>
<li><a href="#converting-between-types">Converting between types</a>
<ul>
<li><a href="#noon-on-a-particular-date">Noon on a particular date</a>
</li>
<li><a href="#birthday-in-2030">Birthday in 2030</a>
</li>
</ul>
</li>
<li><a href="#serialization">Serialization</a>
<ul>
<li><a href="#zoned-instant-from-instant-and-time-zone">Zoned instant from instant and time zone</a>
</li>
</ul>
</li>
<li><a href="#sorting">Sorting</a>
<ul>
<li><a href="#sort-datetimes">Sort DateTimes</a>
</li>
<li><a href="#sort-iso-datetime-strings">Sort ISO date/time strings</a>
</li>
</ul>
</li>
<li><a href="#rounding">Rounding</a>
<ul>
<li><a href="#round-a-time-down-to-whole-hours">Round a time down to whole hours</a>
</li>
<li><a href="#round-a-date-to-the-nearest-start-of-the-month">Round a date to the nearest start of the month</a>
</li>
</ul>
</li>
<li><a href="#time-zone-conversion">Time zone conversion</a>
<ul>
<li><a href="#preserving-local-time">Preserving local time</a>
</li>
<li><a href="#preserving-exact-time">Preserving exact time</a>
</li>
<li><a href="#daily-occurrence-in-local-time">Daily occurrence in local time</a>
</li>
<li><a href="#utc-offset-for-a-zoned-event-as-a-string">UTC offset for a zoned event, as a string</a>
</li>
<li><a href="#utc-offset-for-a-zoned-event-as-a-number-of-seconds">UTC offset for a zoned event, as a number of seconds</a>
</li>
<li><a href="#offset-between-two-time-zones-at-an-exact-time">Offset between two time zones at an exact time</a>
</li>
<li><a href="#dealing-with-dates-and-times-in-a-fixed-location">Dealing with dates and times in a fixed location</a>
</li>
<li><a href="#book-a-meeting-across-time-zones">Book a meeting across time zones</a>
</li>
</ul>
</li>
<li><a href="#arithmetic">Arithmetic</a>
<ul>
<li><a href="#how-many-days-until-a-future-date">How many days until a future date</a>
</li>
<li><a href="#unit-constrained-duration-between-now-and-a-pastfuture-zoned-event">Unit-constrained duration between now and a past/future zoned event</a>
</li>
<li><a href="#nearest-offset-transition-in-a-time-zone">Nearest offset transition in a time zone</a>
</li>
<li><a href="#comparison-of-an-exact-time-to-business-hours">Comparison of an exact time to business hours</a>
</li>
<li><a href="#flight-arrivaldepartureduration">Flight arrival/departure/duration</a>
</li>
<li><a href="#push-back-a-launch-date">Push back a launch date</a>
</li>
<li><a href="#schedule-a-reminder-ahead-of-matching-a-record-setting-duration">Schedule a reminder ahead of matching a record-setting duration</a>
</li>
<li><a href="#nth-weekday-of-the-month">Nth weekday of the month</a>
</li>
<li><a href="#manipulating-the-day-of-the-month">Manipulating the day of the month</a>
</li>
<li><a href="#same-date-in-another-month">Same date in another month</a>
</li>
<li><a href="#next-weekly-occurrence">Next weekly occurrence</a>
</li>
<li><a href="#weekday-of-yearly-occurrence">Weekday of yearly occurrence</a>
</li>
</ul>
</li>
</ul>

<h2 id="running-the-cookbook-files">Running the cookbook files</h2>
<p>Running cookbook files: see instructions in <a href="https://github.com/tc39/proposal-temporal/tree/main/polyfill#running-cookbook-files">../polyfill/README.md</a></p>
<h2 id="frequently-asked-questions">Frequently Asked Questions</h2>
<p>These are some of the most common tasks that people ask questions about on StackOverflow with legacy Date.
Here&#39;s how they would look using Temporal.</p>
<h3 id="current-date-and-time"><a class="heading-link" href="#current-date-and-time"></a>Current date and time</h3><p>How to get the current date and time in the local time zone?</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getCurrentDate<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Note that if you just want the date and not the time, you should use <code>Temporal.PlainDate</code>.
If you want both, use <code>Temporal.PlainDateTime</code>.</p>
<h3 id="unix-timestamp"><a class="heading-link" href="#unix-timestamp"></a>Unix timestamp</h3><p>How to get a Unix timestamp?</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getTimeStamp<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="converting-between-temporal-types-and-legacy-date">Converting between Temporal types and legacy Date</h2>
<h3 id="instant-from-legacy-date"><a class="heading-link" href="#instant-from-legacy-date"></a>Instant from legacy Date</h3><p>Map a legacy ECMAScript Date instance into a Temporal.Instant instance corresponding to the same instant in exact time.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> instantFromLegacyDate<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="construction">Construction</h2>
<h3 id="time-zone-object-from-name"><a class="heading-link" href="#time-zone-object-from-name"></a>Time zone object from name</h3><p><code>Temporal.TimeZone.from()</code> can convert an IANA time zone name into a <code>Temporal.TimeZone</code> object.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getTimeZoneObjectFromIanaName<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="calendar-input-element"><a class="heading-link" href="#calendar-input-element"></a>Calendar input element</h3><p>You can use Temporal objects to set properties on a calendar control.
Here is an example using an HTML <code>&lt;input type=&quot;date&quot;&gt;</code> element with any day beyond “today” disabled and not selectable.</p>
<input type="date" id="calendar-input">

<script type="text/javascript">
const datePicker = document.getElementById('calendar-input');
const browserCalendar = new Intl.DateTimeFormat().resolvedOptions().calendar;
const today = Temporal.now.plainDate(browserCalendar);
datePicker.max = today;
datePicker.value = today;

</script>

<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> calendarInput<span class="token punctuation">.</span>js<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="converting-between-types">Converting between types</h2>
<h3 id="noon-on-a-particular-date"><a class="heading-link" href="#noon-on-a-particular-date"></a>Noon on a particular date</h3><p>An example of combining a calendar date (<code>Temporal.PlainDate</code>) and a wall-clock time (<code>Temporal.PlainTime</code>) into a <code>Temporal.PlainDateTime</code>.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> noonOnDate<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="birthday-in-2030"><a class="heading-link" href="#birthday-in-2030"></a>Birthday in 2030</h3><p>An example of combining a day on the calendar (<code>Temporal.PlainMonthDay</code>) and a year into a <code>Temporal.PlainDate</code>.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> birthdayIn2030<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="serialization">Serialization</h2>
<h3 id="zoned-instant-from-instant-and-time-zone"><a class="heading-link" href="#zoned-instant-from-instant-and-time-zone"></a>Zoned instant from instant and time zone</h3><p>To serialize an exact-time Temporal.Instant into a string, use <code>toString()</code>.
Without any arguments, this gives you a string in UTC time.</p>
<p>If you need your string to include a UTC offset, then use the <code>timeZone</code> option of <code>Temporal.Instant.prototype.toString()</code> which will return a string serialization of the wall-clock time in that time zone corresponding to the exact time.</p>
<p>This loses the information about which time zone the string was in, because it only preserves the UTC offset from the time zone at that particular exact time.
If you need your string to include the time zone name, use Temporal.ZonedDateTime instead, which retains this information.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getParseableZonedStringAtInstant<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="sorting">Sorting</h2>
<p>Each Temporal type has a <code>compare()</code> static method, which can be passed to <code>Array.prototype.sort()</code> as the compare function in order to sort an array of Temporal types.</p>
<h3 id="sort-datetimes"><a class="heading-link" href="#sort-datetimes"></a>Sort DateTimes</h3><p>Sort a list of <code>Temporal.PlainDateTime</code>s, for example in order to get a conference schedule in the correct order.
Sorting other Temporal types would work exactly the same way as this.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getSortedLocalDateTimes<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="sort-iso-datetime-strings"><a class="heading-link" href="#sort-iso-datetime-strings"></a>Sort ISO date/time strings</h3><p>Sort a list of ISO 8601 date/time strings, for example to place log entries in order.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> sortExactTimeStrings<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="rounding">Rounding</h2>
<h3 id="round-a-time-down-to-whole-hours"><a class="heading-link" href="#round-a-time-down-to-whole-hours"></a>Round a time down to whole hours</h3><p>Use the <code>round()</code> method of each Temporal type if you want to round the time fields.
Here&#39;s an example of rounding a time <em>down</em> to the previously occurring whole hour:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> roundDownToWholeHours<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="round-a-date-to-the-nearest-start-of-the-month"><a class="heading-link" href="#round-a-date-to-the-nearest-start-of-the-month"></a>Round a date to the nearest start of the month</h3><p>Rounding is only defined for time fields.
Rounding a date field can be ambiguous, so date-only types such as <code>Temporal.PlainDate</code> don&#39;t have a <code>round()</code> method.
If you need to round a date to the nearest month, for example, then you must explicitly pick what kind of rounding you want.
Here is an example of rounding to the nearest start of a month, rounding up in case of a tie:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> roundToNearestMonth<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>See also <a href="#push-back-a-launch-date">Push back a launch date</a> for an easier way to round up unconditionally to the <em>next</em> start of a month.</p>
<h2 id="time-zone-conversion">Time zone conversion</h2>
<h3 id="preserving-local-time"><a class="heading-link" href="#preserving-local-time"></a>Preserving local time</h3><p>Map a zoneless date and time of day into a <code>Temporal.Instant</code> instance at which the local date and time of day in a specified time zone matches it.
This is easily done with <code>dateTime.toInstant()</code>, but here is an example of implementing different disambiguation behaviors than the <code>&#39;compatible&#39;</code>, <code>&#39;earlier&#39;</code>, <code>&#39;later&#39;</code>, and <code>&#39;reject&#39;</code> ones built in to Temporal.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getInstantWithLocalTimeInZone<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="preserving-exact-time"><a class="heading-link" href="#preserving-exact-time"></a>Preserving exact time</h3><p>Map a zoned date and time of day into a string serialization of the local time in a target time zone at the corresponding exact time.
This could be used when converting user-input date-time values between time zones.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getParseableZonedStringWithLocalTimeInOtherZone<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Here is another example similar to the previous one, using the time zone for future events.
The times and locations of a series of future meetings are stored as a pair of strings: one for the calendar date and wall-clock time, and one for the time zone.
They cannot be stored as an exact time because between now and the time when the event happens, the time zone rules for daylight saving time could change &mdash; for example, Brazil abolished daylight saving time in 2019 &mdash; but the meeting would still be held at the same wall-clock time on that date.
So if the time zone rules changed, the event&#39;s exact time would change.</p>
<p>This example calculates the starting times of all the Ecma TC39 meetings in 2019, in local time in Tokyo.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> localTimeForFutureEvents<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="daily-occurrence-in-local-time"><a class="heading-link" href="#daily-occurrence-in-local-time"></a>Daily occurrence in local time</h3><p>Similar to the previous recipe, calculate the exact times of a daily occurrence that happens at a particular local time in a particular time zone.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> calculateDailyOccurrence<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="utc-offset-for-a-zoned-event-as-a-string"><a class="heading-link" href="#utc-offset-for-a-zoned-event-as-a-string"></a>UTC offset for a zoned event, as a string</h3><p>Use <code>Temporal.TimeZone.getOffsetStringFor()</code> to map a <code>Temporal.Instant</code> instance and a time zone into the UTC offset at that exact time in that time zone, as a string.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getUtcOffsetStringAtInstant<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="utc-offset-for-a-zoned-event-as-a-number-of-seconds"><a class="heading-link" href="#utc-offset-for-a-zoned-event-as-a-number-of-seconds"></a>UTC offset for a zoned event, as a number of seconds</h3><p>Similarly, use <code>Temporal.TimeZone.getOffsetNanosecondsFor()</code> to do the same thing for the offset as a number of seconds.
(Remember to divide by 10<sup>9</sup> to convert nanoseconds to seconds.)</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getUtcOffsetSecondsAtInstant<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="offset-between-two-time-zones-at-an-exact-time"><a class="heading-link" href="#offset-between-two-time-zones-at-an-exact-time"></a>Offset between two time zones at an exact time</h3><p>Also using <code>Temporal.TimeZone.getOffsetNanosecondsFor()</code>, we can map a <code>Temporal.Instant</code> instance and two time zones into the signed difference of UTC offsets between those time zones at that exact time, as a number of seconds.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getUtcOffsetDifferenceSecondsAtInstant<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="dealing-with-dates-and-times-in-a-fixed-location"><a class="heading-link" href="#dealing-with-dates-and-times-in-a-fixed-location"></a>Dealing with dates and times in a fixed location</h3><p>Here is an example of Temporal used in a graph, showing fictitious activity for a storage tank in a fixed location (Stockholm, Sweden).
The graph always starts at midnight in the tank&#39;s location, but the graph labels are in the viewer&#39;s time zone.</p>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>

<p><canvas id="storage-tank" width="600" height="400"></canvas></p>
<script type="text/javascript">
// Generate fictitious "data"
const start = Temporal.now.instant().subtract({ hours: 24 });
const blank = Array(24 * 12);
const tankDataX = Array.from(blank, (_, ix) => start.add({ minutes: ix * 5 }));
const tankDataY = Array.from(blank);
tankDataY[0] = 25;
for (let ix = 1; ix < tankDataY.length; ix++) {
  tankDataY[ix] = Math.max(0, tankDataY[ix - 1] + 3 * (Math.random() - 0.5));
}

// tankDataX and tankDataY are X and Y-axis data for the last 24 hours,
// obtained from elsewhere, e.g. const [tankDataX, tankDataY] = fetchData();
// tankDataX is an array of Temporal.Instant, and tankDataY is an array of numbers.

// Show data starting from the most recent midnight in the tank's location (Stockholm)
const tankTimeZone = Temporal.TimeZone.from('Europe/Stockholm');
const labelFormatter = new Intl.DateTimeFormat(undefined, {
  weekday: 'short',
  hour: 'numeric',
  minute: 'numeric',
  timeZone: Temporal.now.timeZone()
});
const browserCalendar = labelFormatter.resolvedOptions().calendar;
const tankMidnight = Temporal.now.plainDate(browserCalendar, tankTimeZone).toPlainDateTime().toInstant(tankTimeZone);
const atOrAfterMidnight = (x) => Temporal.Instant.compare(x, tankMidnight) >= 0;
const dataStartIndex = tankDataX.findIndex(atOrAfterMidnight);
const graphLabels = tankDataX.slice(dataStartIndex).map((x) => labelFormatter.format(x));
const graphPoints = tankDataY.slice(dataStartIndex);

const ctx = document.getElementById('storage-tank').getContext('2d');
// The graph is made with Chart.js (https://www.chartjs.org/)
new Chart(ctx, {
  type: 'line',
  data: {
    labels: graphLabels,
    datasets: [
      {
        label: 'Fill level',
        data: graphPoints
      }
    ]
  },
  options: {
    title: {
      display: true,
      text: 'Stockholm storage tank'
    },
    scales: {
      yAxes: [
        {
          ticks: {
            beginAtZero: true
          }
        }
      ]
    }
  }
});

</script>

<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> storageTank<span class="token punctuation">.</span>js<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="book-a-meeting-across-time-zones"><a class="heading-link" href="#book-a-meeting-across-time-zones"></a>Book a meeting across time zones</h3><p>Across the web there are several tools for finding meeting times that are appropriate for all the participants&#39; time zones, such as <a href="https://www.worldtimebuddy.com/">World Time Buddy</a>, <a href="https://www.timeanddate.com/worldclock/meeting.html">World Clock Meeting Planner</a>, and built into various calendar software.</p>
<style>
  #meeting-planner {
    border-collapse: separate;
    border-spacing: 0 10px;
    font-size: 0.6rem;
    text-align: center;
  }

  /* https://materializecss.com/color.html */
  .time-0, .time-1, .time-2, .time-3, .time-4, .time-5,
  .time-22, .time-23 {
    background-color: #ef9a9a;  /* red lighten-3 */
    border-color: #e57373;  /* red lighten-2 */
    border-style: solid;
    border-width: 0 1px;
  }
  .time-6, .time-7, .time-18, .time-19, .time-20, .time-21 {
    background-color: #fff59d;  /* yellow lighten-3 */
    border-color: #ffd54f;  /* amber lighten-2 */
    border-style: solid;
    border-width: 0 1px;
  }
  .time-8, .time-9, .time-10, .time-11, .time-12, .time-13,
  .time-14, .time-15, .time-16, .time-17 {
    background-color: #a5d6a7;  /* green lighten-3 */
    border-color: #81c784;  /* green lighten-2 */
    border-style: solid;
    border-width: 0 1px;
  }

  .time-0 {
    border-bottom-left-radius: 12px;
    border-left-color: white;
    border-left-width: 2px;
    border-top-left-radius: 12px;
    font-weight: bold;
  }
  .time-23 {
    border-bottom-right-radius: 12px;
    border-right-color: white;
    border-right-width: 2px;
    border-top-right-radius: 12px;
  }

  .time-current {
    border: 2px solid black;
  }
</style>

<table id="meeting-planner">
</table>

<script type="text/javascript" id="meeting-planner-source">
// Display local time zone and three others
const here = Temporal.now.timeZone();
const now = Temporal.now.instant();
const timeZones = [
  { name: 'Here', tz: here },
  { name: 'New York', tz: Temporal.TimeZone.from('America/New_York') },
  { name: 'London', tz: Temporal.TimeZone.from('Europe/London') },
  { name: 'Tokyo', tz: Temporal.TimeZone.from('Asia/Tokyo') }
];

// Start the table at midnight local time
const browserCalendar = new Intl.DateTimeFormat().resolvedOptions().calendar;
const calendarNow = now.toPlainDateTime(here, browserCalendar);
const startTime = calendarNow
  .with(Temporal.PlainTime.from('00:00')) // midnight
  .toInstant(here);

// Build the table
const table = document.getElementById('meeting-planner');
timeZones.forEach(({ name, tz }) => {
  const row = document.createElement('tr');

  const title = document.createElement('td');
  title.textContent = `${name} (UTC${tz.getOffsetStringFor(now)})`;
  row.appendChild(title);

  for (let hours = 0; hours < 24; hours++) {
    const cell = document.createElement('td');

    const dt = startTime.add({ hours }).toPlainDateTime(tz);
    cell.className = `time-${dt.hour}`;

    // Highlight the current hour in each row
    if (hours === calendarNow.hour) cell.className += ' time-current';

    // Show the date in midnight cells
    let formatOptions;
    if (dt.hour === 0) {
      formatOptions = { month: 'short', day: 'numeric' };
    } else {
      formatOptions = { hour: 'numeric' };
    }
    cell.textContent = dt.toLocaleString(undefined, formatOptions);
    row.appendChild(cell);
  }

  table.appendChild(row);
});

</script>

<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> meetingPlanner<span class="token punctuation">.</span>js<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="arithmetic">Arithmetic</h2>
<h3 id="how-many-days-until-a-future-date"><a class="heading-link" href="#how-many-days-until-a-future-date"></a>How many days until a future date</h3><p>An example HTML form inspired by <a href="https://www.timeanddate.com/date/durationresult.html">Days Calculator</a> on timeanddate.com:</p>
<form action="#how-many-days-until-a-future-date">
  <label>
    Enter future date:
    <input type="date" name="futuredate">
  </label>
  <button>Submit</button>
</form>

<div id="futuredate-results"></div>

<script type="text/javascript">
{
  // Do initialization that doesn't necessarily need to be included in
  // the example; see 'Calendar input element'
  const futureDatePicker = document.querySelector('input[name="futuredate"]');
  const today = Temporal.now.plainDate();
  futureDatePicker.min = today;
  futureDatePicker.value = today.add({ months: 1 });
}
// Form parameters
const params = new URL(document.location).searchParams;
const futuredateParam = params.get('futuredate');

// If you have Intl.DurationFormat, then you can do this with
// until.toLocaleString() and untilMonths.toLocaleString(). This
// example will be updated when that becomes possible. For now, we can
// generate the string only in English.
function englishPlural(n, singular, plural) {
  return `${n} ${n === 1 ? singular : plural}`;
}

// When form data posted:
if (futuredateParam !== null) {
  const futureDate = Temporal.PlainDate.from(futuredateParam);
  const browserCalendar = new Intl.DateTimeFormat().resolvedOptions().calendar;
  const today = Temporal.now.plainDate(browserCalendar);
  const until = today.until(futureDate, { largestUnit: 'days' });
  const untilMonths = until.round({ largestUnit: 'months', relativeTo: today });

  const dayString = englishPlural(until.days, 'day', 'days');
  const monthString =
    `${englishPlural(untilMonths.months, 'month', 'months')}` +
    (untilMonths.days !== 0 ? `, ${englishPlural(untilMonths.days, 'day', 'days')}` : '');

  const results = document.getElementById('futuredate-results');
  results.innerHTML = `
    <p>From and including: <strong>${today.toLocaleString()}</strong></p>
    <p>To but not including: <strong>${futureDate.toLocaleString()}</strong></p>
    <h4>Result: ${dayString}</h4>
    <p>It is ${dayString} from the start date to the end date, but not
    including the end date.</p>
    <p>Or ${monthString} excluding the end date.</p>
  `;
}

</script>

<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> futureDateForm<span class="token punctuation">.</span>js<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="unit-constrained-duration-between-now-and-a-pastfuture-zoned-event"><a class="heading-link" href="#unit-constrained-duration-between-now-and-a-pastfuture-zoned-event"></a>Unit-constrained duration between now and a past/future zoned event</h3><p>Take the difference between two Temporal.Instant instances as a Temporal.Duration instance (positive or negative), representing the duration between the two instants without using units coarser than specified (e.g., for presenting a meaningful countdown with vs. without using months or days).</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getElapsedDurationSinceInstant<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="nearest-offset-transition-in-a-time-zone"><a class="heading-link" href="#nearest-offset-transition-in-a-time-zone"></a>Nearest offset transition in a time zone</h3><p>Map a Temporal.Instant instance and a Temporal.TimeZone object into a Temporal.Instant instance representing the nearest following exact time at which there is an offset transition in the time zone (e.g., for setting reminders).</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getInstantOfNearestOffsetTransitionToInstant<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="comparison-of-an-exact-time-to-business-hours"><a class="heading-link" href="#comparison-of-an-exact-time-to-business-hours"></a>Comparison of an exact time to business hours</h3><p>This example takes a roster of wall-clock opening and closing times for a business, and maps an exact time into a time-sensitive state indicator (&quot;opening soon&quot; vs. &quot;open&quot; vs. &quot;closing soon&quot; vs. &quot;closed&quot;).</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getBusinessOpenStateText<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="flight-arrivaldepartureduration"><a class="heading-link" href="#flight-arrivaldepartureduration"></a>Flight arrival/departure/duration</h3><p>Map localized trip departure and arrival times into trip duration in units no larger than hours.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getTripDurationInHrMinSec<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Given a departure time with time zone and a flight duration, get an arrival time in the destination time zone, using time zone-aware math.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getLocalizedArrival<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="push-back-a-launch-date"><a class="heading-link" href="#push-back-a-launch-date"></a>Push back a launch date</h3><p>Add the number of days it took to get an approval, and advance to the start of the following month.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> plusAndRoundToMonthStart<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="schedule-a-reminder-ahead-of-matching-a-record-setting-duration"><a class="heading-link" href="#schedule-a-reminder-ahead-of-matching-a-record-setting-duration"></a>Schedule a reminder ahead of matching a record-setting duration</h3><p>When considering a record (for example, a personal-best time in a sport), you might want to receive an alert just before the record is about to be broken.
This example takes a record as a <code>Temporal.Duration</code>, the starting exact time of the current attempt as a <code>Temporal.Instant</code>, and another <code>Temporal.Duration</code> indicating how long before the potentially record-setting exact time you would like to receive an alert.
It returns the exact time at which a notification could be sent, for example &quot;Keep going! 5 more minutes and it will be your personal best!&quot;</p>
<p>This could be used for workout tracking, racing (including <em>long</em> and potentially time-zone-crossing races like the Bullrun Rally, Iditarod, Self-Transcendence 3100, and Clipper Round The World), or even open-ended analogs like event-every-day &quot;streaks&quot;.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getInstantBeforeOldRecord<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="nth-weekday-of-the-month"><a class="heading-link" href="#nth-weekday-of-the-month"></a>Nth weekday of the month</h3><p>Example of getting a <code>Temporal.PlainDate</code> representing the first Tuesday of the given <code>Temporal.PlainYearMonth</code>, adaptable to other weekdays.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getFirstTuesdayOfMonth<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Given a <code>Temporal.PlainYearMonth</code> instance and an ISO 8601 ordinal calendar day of the week ranging from 1 (Monday) to 7 (Sunday), return a chronologically ordered array of <code>Temporal.PlainDate</code> instances corresponding with every day in the month that is the specified day of the week (of which there will always be either four or five).</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> getWeeklyDaysInMonth<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><p>Given a <code>Temporal.PlainDate</code> instance, return the count of preceding days in its month that share its day of the week.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> countPrecedingWeeklyDaysInMonth<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="manipulating-the-day-of-the-month"><a class="heading-link" href="#manipulating-the-day-of-the-month"></a>Manipulating the day of the month</h3><p>Here are some examples of taking an existing date, and adjusting the day of the month.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> adjustDayOfMonth<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="same-date-in-another-month"><a class="heading-link" href="#same-date-in-another-month"></a>Same date in another month</h3><p>Likewise, here are some examples of taking an existing date and adjusting the month, but keeping the day and year the same.</p>
<p>Depending on the behaviour you want, you will need to pick the right <code>overflow</code> option, but the default of <code>&quot;constrain&quot;</code> should be correct for most cases.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> adjustMonth<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="next-weekly-occurrence"><a class="heading-link" href="#next-weekly-occurrence"></a>Next weekly occurrence</h3><p>From a <code>Temporal.Instant</code> instance and a local <code>Temporal.TimeZone</code>, get a <code>Temporal.PlainDateTime</code> representing the next occurrence of a weekly event that is scheduled on a particular weekday and time in a particular time zone. (For example, &quot;weekly on Thursdays at 08:45 California time&quot;).</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> nextWeeklyOccurrence<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="weekday-of-yearly-occurrence"><a class="heading-link" href="#weekday-of-yearly-occurrence"></a>Weekday of yearly occurrence</h3><p>In some countries, when a public holiday falls on a Tuesday or Thursday, an extra &quot;bridge&quot; public holiday is observed on Monday or Friday in order to give workers a long weekend off.
The following example calculates this.</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    cookbook <span class="token operator">/</span> bridgePublicHolidays<span class="token punctuation">.</span>mjs<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>    <footer>
      <p>
        This page includes a script which loads an implementation of Temporal in your browser.
        You can open a console in your browser's developer tools and try it out directly!
      </p>
      <p>View this or help contribute on <a href="https://github.com/tc39/proposal-temporal">GitHub</a>.</p>
    </footer>
  </body>
</html>
